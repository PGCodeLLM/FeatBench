[common]
# GitHub API configuration
github_api_base = "https://api.github.com"

# OpenAI API configuration
openai_model = "deepseek-chat"
openai_base_url = "https://api.deepseek.com"

# Output directory configuration
output_dir = "results"

# Crawl mode configuration
crawl_mode = "stars"  # "stars" or "specified"
crawl_json_file = "crawl.json"

[release_collector]
# Filtering thresholds
min_stars_range = 5000
default_release_limit = 30
min_releases = 5
min_release_body_length = 50
min_release_date = "2024-06-01"
rank_start = 0
rank_end = 100

# Excluded topics
excluded_topics = ["tutorial", "beginner", "example", "course", "boilerplate", "book", "awesome", "books", "education", "learning", "demo", "starter", "guide"]

# Test case related configuration
test_directories = ["test", "tests", "testing", "spec", "specs"]
test_file_patterns = ["test_.*\\.py$", ".*_test\\.py$", ".*_spec\\.py$", "conftest\\.py$"]
bot_users = ["github-actions[bot]", "dependabot[bot]", "renovate[bot]", "greenkeeper[bot]"]

# Cache file
cache_file = "processed_repos_cache.json"

[release_analyzer]
# Cache file
analysis_cache_file = "release_analysis_cache.json"

# README processing configuration
max_readme_length = 2000
readme_truncation_suffix = "...(truncated)"

[pr_analyzer]
# Cache file
pr_analysis_cache_file = "pr_analysis_cache.json"

# File change summary configuration
max_files_in_summary = 1000
max_patch_length = 6000000
max_patch_preview_length = 6000000

[main]
# Final results file
final_results_file = "final_analysis_results.json"

# Print parameters
sample_results_limit = 5

[prompts]
release_analysis_system = "You are a software development expert who specializes in analyzing release notes and categorizing software changes."

release_analysis_user = """{readme_context}Analyze the following software release notes and categorize the changes into: new_features, improvements, bug_fixes, and other_changes.
For each change, extract any PR references (like #123, PR456, pull #789, etc.) mentioned in the text.

Release version: {tag_name}
Release notes:
{release_body}

Guidelines:
1. new_features: Brand new functionality, commands, rules, or capabilities
2. improvements: Enhancements to existing features, optimizations, performance improvements
3. bug_fixes: Bug fixes, error handling, crash fixes
4. other_changes: Documentation updates, dependency updates, refactoring (only if significant)
5. Extract PR numbers from various formats: #123, PR #456, pull 789, (#101), etc.
6. Only include PR numbers that are explicitly mentioned with the change
7. Ignore trivial changes like version bumps unless they're part of larger features
8. Use the repository context to better understand the project's domain and categorize changes more accurately

Return the result in JSON format:
{{
    "new_features": [
        {{
            "description": "Brief description of the new feature",
            "pr_ids": ["123", "456"]
        }}
    ],
    "improvements": [
        {{
            "description": "Brief description of the improvement",
            "pr_ids": ["789"]
        }}
    ],
    "bug_fixes": [
        {{
            "description": "Brief description of the bug fix",
            "pr_ids": ["101"]
        }}
    ],
    "other_changes": [
        {{
            "description": "Brief description of other changes",
            "pr_ids": []
        }}
    ]
}}
"""

pr_analysis_system = "You are a requirements analyst who creates comprehensive user requirement descriptions that will be used to instruct coding LLMs to implement functionality. Your descriptions must be detailed enough for another LLM to recreate the exact same implementation without seeing the original code. Always start with 'I want to' and write from the user's perspective about what they need to accomplish."

pr_analysis_user = """You are creating a user requirement description that will be used to instruct another LLM to implement the exact same functionality. Your task is to analyze the PR information and code changes, then write a comprehensive user request that describes what the user wants to accomplish.

This description will be given to a coding LLM to generate the implementation, so you must ensure all functionality across all modified files is thoroughly described from the user's perspective.

Original Feature Description: {feature_description}

PR Title: {pr_title}
PR Description: {pr_body}

File Changes:
{files_text}

Your user requirement description must:
- Start with "I want to" and write as if a user is requesting this functionality from a developer
- Include ALL information from the original PR Description - do not omit any details, requirements, or context provided there
- Describe what the user wants to accomplish with complete detail for every file that was modified
- Include all functional requirements that would be needed to recreate this exact implementation
- When functions/methods have parameter changes (additions, deletions, modifications), describe what the user needs in terms of input data and configuration options, mentioning specific parameter names naturally within the context of the requirement
- Focus on the complete user workflow and all capabilities they need
- Describe the expected behavior and outcomes the user wants to achieve
- Ensure a coding LLM reading this could implement all the functionality without seeing the original code
- Write as a natural user request, not technical documentation
- Avoid phrases like "implement function X" or "modify file Y" - instead describe what the user wants to accomplish
- Do NOT include any actual code implementations, code snippets, or technical syntax - only describe the desired functionality and behavior from a user perspective
- Focus on WHAT the user wants to achieve, not HOW it should be implemented technically

Remember: This description will be the only guide for another LLM to recreate this functionality, so include every important detail about what the user wants to achieve, but express it as natural user requirements. You must incorporate all information from the original PR description. Never include code - only describe the desired outcomes and behaviors."""

feature_analysis_system = "You help users understand software features by writing comprehensive, user-focused descriptions. Always start responses with 'I want to' and explain what users can accomplish and the practical value they receive. Synthesize information from multiple sources to show complete user benefits."

feature_analysis_user = """You need to create a comprehensive user-focused description for this complete feature. Analyze all the related pull requests to understand what this feature enables users to do.

Feature Type: {feature_type}
Original Description: {feature_description}

Associated Pull Requests:
{prs_text}

Your description must:
- Start with "I want to" and focus on what users can accomplish
- Explain the specific capabilities this complete feature provides
- Show how all related changes work together to benefit users
- Highlight what new things users can now do that they couldn't before
- Demonstrate how this improves user workflow and productivity
- Explain the practical value users receive from this feature
- Combine insights from all PRs to show the complete picture
- Focus on user benefits rather than technical implementation
- Explain why this feature matters to users in real-world usage

Write directly from the user's perspective about what they can accomplish and the complete value they receive from this feature."""
